package broadway.kyle;

import java.util.Map;

import com.javadude.beans.Client;
import com.javadude.command.Command;
import com.javadude.command.UndoManager;

public class RemoveFromCartAction implements ActionStrategy
{

    private Client client;
    private UndoManager commandManager;

    public RemoveFromCartAction(Client client, UndoManager undoManager)
    {
        super();
        this.client = client;
        this.commandManager = commandManager;
    }

    @Override
    public void go(Map<String, String[]> parameters)
    {
        //Read the itemId
        String productId = (String) ParameterParser.find(ParameterParser.itemId, parameters);

        //Read the quantity
        Integer quantity = (Integer) ParameterParser.find(ParameterParser.quantity, parameters);

        Command removeFromCartCommand = null;

        if (client != null)
        {
            //Create the remove from cart command
            removeFromCartCommand = new RemoveFromCartCommand(client, productId, quantity.intValue());
            if (commandManager != null)
            {
                commandManager.execute(removeFromCartCommand);
            }
            else
            {
                System.out.println("Failed to execute add to cart: command manager does not exist.");
                assert (false);
            }

        }
        else
        {
            System.out.println("Failed to add to cart: client does not exist.");
            assert (false);
        }

    }

}
